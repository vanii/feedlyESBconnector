<template name="getContentForListOfEntries" xmlns="http://ws.apache.org/ns/synapse">
    <parameter name="entryId" description="Id of the Entry." />
    <sequence>
        <property name="uri.var.entryId" expression="$func:entryId" />

        <script language="js">
            <![CDATA[

			var entries = ''+mc.getProperty('uri.var.entryId');
			var entriesObj = eval ("(" + entries + ")");

            var query = '[';
            var added = 0;
            for(var i in entriesObj) {
                var temp = entriesObj[i];
                if(added == 0) {
                    query = query + '"'+temp+'"';
                    added = 1;
                }else {
                    query = query + ',"'+temp+'"';
                }
            }

            query = query + ']';
            mc.setProperty('uri.var.query', query);
	 	]]>
        </script>

        <log level="custom">
            <property name="entries" expression="get-property('uri.var.query')"/>
        </log>

        <header name="Content-Type" value="application/json"
                scope="transport" />
        <property name="messageType" value="application/json"
                  scope="axis2" />


        <payloadFactory media-type="json">
            <format>
                $1
            </format>
            <args>
                <arg expression="get-property('uri.var.query')" />
            </args>
        </payloadFactory>

        <call>
            <endpoint>
                <http method="post"
                      uri-template="http://cloud.feedly.com/v3/entries/.mget" />
            </endpoint>
        </call>
    </sequence>
</template>